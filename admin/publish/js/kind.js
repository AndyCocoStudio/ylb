!function(){var n={chosekind:"",chosekindcode:"",sublist:[],cover:!1,gnewkind:!1,parentcode:"",newkindname:""},e={init:function(){e.getList()},getList:function(){$.when($.ajax({url:$.apiUrl+"/kinds",type:"GET"})).done(function(i){$.ylbAjaxHandler(i,function(){n.list=i.data,e.buildVue()})})},getSubList:function(e){$.when($.ajax({url:$.apiUrl+"/kinds?code="+e,type:"GET"})).done(function(e){$.ylbAjaxHandler(e,function(){n.sublist=e.data})})},buildVue:function(){n=new Vue({el:"#kind-main",data:n,methods:{hideall:function(){n.cover=!1,n.gnewkind=!1},showmore:function(i){var t=$(i.target);n.chosekind=t.attr("data-name"),n.chosekindcode=t.attr("data-code"),e.getSubList(n.chosekindcode)},shownewkind:function(e){n.parentcode=e,n.cover=!0,n.gnewkind=!0},addkind:function(){$.ajax({url:$.apiUrl+"/kinds",type:"PUT",data:JSON.stringify({name:n.newkindname,parentCode:n.parentcode})}).done(function(i){$.ylbAjaxHandler(i,function(){$.ylbAlert("添加成功！"),n.parentcode="",n.hideall(),e.getList(),n.chosekindcode&&e.getSubList(n.chosekindcode)})})},editkind:function(n,e,i){$.ajax({url:$.apiUrl+"/kinds",type:"POST",data:JSON.stringify({name:i,parentCode:n,code:e})}).done(function(n){$.ylbAjaxHandler(n,function(){$.ylbAlert("添加成功！")})})},delkind:function(i,t){var d=confirm("确认要删除该类目？");if(d){var a=[];a.push(i),$.ajax({url:$.apiUrl+"/kinds/remove",type:"POST",data:JSON.stringify({codes:a})}).done(function(i){$.ylbAjaxHandler(i,function(){$.ylbAlert("删除成功！"),1==t?(e.getList(),n.chosekindcode=""):e.getSubList(n.chosekindcode)})})}}}})}};e.init()}();