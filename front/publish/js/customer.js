!function(){var t={covershow:!1,sendshow:!1,spendshow:!1,applyrole:-1,sid:$.getID(),spendpoint:{name:"",type:"",count:"",total:"",point:"",mobile:""}},n={init:function(){$.checkSession(),n.getUserInfo()},createQRcode:function(){var n="http://www.hnylbsc.com/sendpoint.html?uid="+t.info.mobile;$("#customer-private-qrcode").qrcode({render:"table",width:130,height:130,text:n})},getUserInfo:function(){$.when($.ajax({url:$.apiUrl+"/user/abstract",type:"GET"})).done(function(e){$.ylbAjaxHandler(e,function(){t.info=e.data,n.buildVue()})})},buildVue:function(){t=new Vue({el:"#customer-main",data:t,methods:{sendpoints:function(){this.covershow=!0,this.sendshow=!0},spendpoints:function(){this.covershow=!0,this.spendshow=!0},hideall:function(){this.covershow=!1,this.sendshow=!1,this.spendshow=!1},pchange:function(){this.spendpoint.point>.8*this.spendpoint.total&&(this.spendpoint.point=(.8*this.spendpoint.total).toFixed(2))},getqrcode:function(){this.createSpendpointQRcode()},getpoint:function(){this.getPointPerDay()},getPointPerDay:function(){$.ajax({url:$.apiUrl+"/score/grant",type:"GET"}).done(function(t){$.ylbAjaxHandler(t,function(){$.ylbAlert("领取成功！"),n.getUserInfo()})})},createSpendpointQRcode:function(){$.ajax({url:$.apiUrl+"/order/shoppingoffline",type:"PUT",data:JSON.stringify({goodsName:t.spendpoint.name,goodsKind:t.spendpoint.type,userMobile:t.spendpoint.mobile,score:t.spendpoint.point,quantity:t.spendpoint.count,totalPrice:t.spendpoint.total})}).done(function(t){$.ylbAjaxHandler(t,function(){var n="http://www.hnylbsc.com/spendpoint.html?oid="+t.data;$("#spendpoint-qrcode").qrcode({render:"table",width:240,height:240,text:n})})})}}}),n.createQRcode()}};n.init()}();