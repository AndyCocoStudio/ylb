!function(){var e={sid:$.getID(),avatar:!1,address:!1,password:!0,detail:!1,pwd:{},newaddress:{id:"",name:"",mobile:"",province:"",provinceCode:"",city:"",cityCode:"",area:"",areaCode:"",street:"",postCode:"",isDefault:1},useravatar:"",plist:[],clist:[],alist:[]},a={init:function(){$.checkSession(),a.getPlist(),a.getUserInfo(),a.uploadavatar()},uploadavatar:function(){$("#txsc").dropzone({url:$.apiUrl+"/upload",paramName:"file",maxFiles:1,maxFilesize:1,acceptedFiles:"image/*",addRemoveLinks:!0,dictResponseError:"上传文件出错！",success:function(a,t){e.useravatar=t.data}})},createQRcode:function(){var a="http://www.hnylbsc.com/sendpoint.html?uid="+e.info.mobile;$("#customer-private-qrcode").qrcode({render:"table",width:130,height:130,text:a})},getUserInfo:function(){$.when($.ajax({url:$.apiUrl+"/user/abstract",type:"GET"})).done(function(t){$.ylbAjaxHandler(t,function(){e.info=t.data,e.useravatar=t.data.avatar,a.getAddress()})})},getAddress:function(){$.when($.ajax({url:$.apiUrl+"/user/addresses",type:"GET"})).done(function(t){$.ylbAjaxHandler(t,function(){e.addrList=t.data,a.getDetail()})})},getDetail:function(){$.when($.ajax({url:$.apiUrl+"/user/detail",type:"GET"})).done(function(t){$.ylbAjaxHandler(t,function(){e.userDetail=t.data,a.buildVue()})})},getPlist:function(){$.when($.ajax({url:$.apiUrl+"/address",type:"GET"})).done(function(a){$.ylbAjaxHandler(a,function(){e.plist=a.data})})},getClist:function(a){$.when($.ajax({url:$.apiUrl+"/address?code="+a,type:"GET"})).done(function(a){$.ylbAjaxHandler(a,function(){e.clist=a.data})})},getAlist:function(a){$.when($.ajax({url:$.apiUrl+"/address?code="+a,type:"GET"})).done(function(a){$.ylbAjaxHandler(a,function(){e.alist=a.data})})},buildVue:function(){e=new Vue({el:"#customer-main",data:e,methods:{changetap:function(e){var a=$(e.target),t=a.attr("data-role");switch(t){case"avatar":this.avatar=!0,this.address=!1,this.password=!1,this.detail=!1;break;case"address":this.avatar=!1,this.address=!0,this.password=!1,this.detail=!1;break;case"password":this.avatar=!1,this.address=!1,this.password=!0,this.detail=!1;break;case"detail":this.avatar=!1,this.address=!1,this.password=!1,this.detail=!0;break;default:this.avatar=!1,this.address=!1,this.password=!0,this.detail=!1}},confirmpwd:function(){},changeprov:function(t){var s=$(t.target),d=s.val(),i=s.find("option:selected").text();e.newaddress.provinceCode=d,e.newaddress.province=i,e.alist=[],a.getClist(d)},changecity:function(t){var s=$(t.target),d=s.val(),i=s.find("option:selected").text();e.newaddress.cityCode=d,e.newaddress.city=i,a.getAlist(d)},changearea:function(a){var t=$(a.target),s=t.val(),d=t.find("option:selected").text();e.newaddress.areaCode=s,e.newaddress.area=d},saveaddress:function(){if(e.newaddress.id);else{var t={name:e.newaddress.name,mobile:e.newaddress.mobile,province:e.newaddress.province,provinceCode:e.newaddress.provinceCode,city:e.newaddress.city,cityCode:e.newaddress.cityCode,area:e.newaddress.area,areaCode:e.newaddress.areaCode,street:e.newaddress.street,postCode:e.newaddress.postCode,isDefault:1};$.ajax({url:$.apiUrl+"/user/address",type:"PUT",data:JSON.stringify(t)}).done(function(e){$.ylbAjaxHandler(e,function(){$.ylbAlert("地址添加成功"),a.getAddress()})})}}}}),a.createQRcode()}};a.init()}();